<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Um Presente Especial para Voc√™</title>

    <!-- Carrega o Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Carrega a biblioteca de anima√ß√£o GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

    <!-- Carrega a biblioteca de √°udio Tone.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>

    <style>
        /* Importa fontes customizadas do Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Inter:wght@400;600&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            /* Fundo animado */
            background: url('/static/imgs/fundo/fundo.gif') no-repeat center center fixed;
            background-size: cover;
            overflow: hidden;
            /* Previne scroll lateral/vertical */
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }


        /* ESTILOS PARA O BAMBU */
        .bamboo-stalk {
            position: absolute;
            background: linear-gradient(to right, #008000, #228B22, #008000);
            /* Gradiente para dar volume */
            border-top-left-radius: 0.5rem;
            /* 8px */
            border-top-right-radius: 0.5rem;
            /* 8px */
            box-shadow: inset 1px 1px 3px rgba(0, 0, 0, 0.3);
            /* Sombra interna para profundidade */
            transform-origin: bottom center;
            /* Ponto de piv√¥ para a anima√ß√£o de balan√ßo */
            filter: drop-shadow(5px 0px 5px rgba(0, 0, 0, 0.3));
            /* Sombra projetada */
        }

        /* Detalhes de textura (linhas e gradientes) */
        .bamboo-detail {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background: linear-gradient(to right, rgba(0, 0, 0, 0.05), transparent, rgba(0, 0, 0, 0.05));
            /* Gradiente sutil */
            opacity: 0.7;
        }

        .bamboo-line {
            position: absolute;
            width: 1px;
            background-color: rgba(0, 0, 0, 0.1);
            opacity: 0.6;
        }

        /* "N√≥s" do bambu */
        .bamboo-joint {
            position: absolute;
            width: 100%;
            /* Largura total do caule */
            height: 8px;
            /* Altura do n√≥ */
            background-color: rgba(144, 238, 144, 0.7);
            /* Verde claro transparente para o anel */
            border-radius: 9999px;
            /* Arredondado */
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2), inset 0 1px 3px rgba(0, 0, 0, 0.2);
            /* Sombra para destacar e inset para volume */
            left: 0;
            transform: scaleX(1.1);
            /* Um pouco mais largo que o caule */
            z-index: 2;
            /* Para ficar acima dos detalhes de textura */
        }



        /* CH√ÉO DA FLORESTA */
        .ground {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3rem;
            /* 48px */
            background: linear-gradient(to top, #064E3B, rgba(6, 78, 59, 0));
            /* Gradiente do ch√£o para transparente */
            z-index: 25;
            /* Na frente dos pandas de tr√°s, atr√°s dos da frente */
        }

        /* Part√≠culas de Luz (Vaga-lumes) */
        .firefly {
            position: absolute;
            width: 8px;
            height: 8px;
            background-color: #FFFFCC;
            /* Amarelo claro */
            border-radius: 50%;
            box-shadow: 0 0 8px 4px rgba(255, 255, 204, 0.7);
            /* Brilho */
            opacity: 0;
            /* Come√ßa invis√≠vel */
            z-index: 80;
            /* Mesmo n√≠vel da m√°scara de luz/escuro */
        }



        /* Estilos para os pandas do jogo */
        .game-panda {
            position: absolute;
            cursor: pointer;
            /* z-index ser√° definido aleatoriamente no JavaScript */
            transition: transform 0.1s ease;
            user-select: none;
            -webkit-user-select: none;
        }

        .game-panda:hover {
            transform: scale(1.1);
        }

        .game-panda:active {
            transform: scale(0.9);
        }

        /* Tamanho padr√£o para todos os pandas */
        .game-panda img {
            width: 200px;
            height: 200px;
            object-fit: contain;
        }
        
        /* === TAMANHOS INDIVIDUAIS PARA CADA TIPO DE PANDA === */
        
        /* Panda 1: Arco Esquerda->Direita (pandaVoando.png) */
        .panda-type-1 img {
            width: 180px;
            height: 180px;
        }
        
        /* Panda 2: Arco Direita->Esquerda (pandaVoando.png) */
        .panda-type-2 img {
            width: 160px;
            height: 160px;
            transform: scaleX(-1); /* Inverte horizontalmente */
        }
        
        /* Panda 3: Agachamento Aleat√≥rio (renam.png) */
        .panda-type-3 img {
            width: 220px;
            height: 220px;
        }
        
        /* Panda 4: Bola de Canh√£o Vertical (pandaRolando.png) */
        .panda-type-4 img {
            width: 140px;
            height: 140px;
        }
        
        /* Panda 5: Bola de Canh√£o Horizontal (pandaRolando.png) */
        .panda-type-5 img {
            width: 150px;
            height: 150px;
        }
        
        /* Panda Final: Panda Marrom (renanMarrom.png) - Jumpscare */
        .panda-final img {
            width: 300px;
            height: 300px;
        }
        @media (max-width: 768px) {

            /* Ajusta a caixa de instru√ß√µes */
            #instructions {
                padding: 1rem;
                /* Era p-6 */
                width: 90%;
                /* Limita a largura */
            }


            /* Ajusta a caixa de mensagem */
            #message-box {
                padding: 1.5rem;
                /* Era p-8 */
            }

            #message-text {
                font-size: 1.75rem;
                /* Era 3xl */
            }

            /* Oculta bambus espec√≠ficos em telas pequenas */
            .bamboo-mobile-hidden {
                display: none;
            }
            
            /* Ajusta vaga-lumes para telas pequenas */
            .firefly {
                width: 6px;
                height: 6px;
                /* Reduz tamanho em telas pequenas */
            }
        }
        
        /* Ajuste espec√≠fico para telas muito pequenas (360px) */
        @media (max-width: 360px) {
            .firefly {
                width: 4px;
                height: 4px;
                /* Tamanho ainda menor para telas muito pequenas */
            }
        }
    </style>
</head>

<body class="relative w-screen h-screen">
    <!-- Mensagem de orienta√ß√£o para celular -->
    <div id="orientation-message"
        class="fixed inset-0 bg-black z-[100] flex flex-col items-center justify-center p-4 text-center text-white transition-opacity duration-500 md:hidden">
        <div class="mb-4 text-6xl">üîÑ</div>
        <h2 class="text-2xl font-bold mb-2">Gire seu celular</h2>
        <p class="text-lg">Para melhor experi√™ncia, jogue no modo paisagem (deitado)</p>
        <button id="fullscreen-btn" class="mt-6 px-6 py-3 bg-blue-500 text-white rounded-lg font-medium">Tela
            Cheia</button>
    </div>
    <!-- Canvas para m√°scara de luz/escuro da introdu√ß√£o -->
    <canvas id="introCanvas" class="fixed inset-0 z-[80] pointer-events-none"></canvas>



    <!-- Overlay e Modal (Caixa de Mensagem) -->
    <div id="overlay"
        class="fixed inset-0 w-full h-full bg-black/70 backdrop-blur-sm flex items-center justify-center z-[70]"
        style="visibility: hidden; opacity: 0;">
        <div id="message-box"
            class="message-box bg-white p-8 md-p-12 rounded-2xl shadow-2xl text-center max-w-md mx-4 transform scale-0 opacity-0">
            <p id="message-text" class="text-3xl md:text-4xl text-emerald-800 transition-all duration-300">
                Texto da sorte aqui!
            </p>
            <span class="block text-sm text-gray-500 mt-4">(Clique fora para fechar)</span>
        </div>
    </div>


    <!-- A Cena Principal -->
    <div id="scene" class="relative w-full h-full overflow-hidden">
        <!-- Container para os Pandas do Jogo -->
        <div id="panda-game-container" class="absolute inset-0 w-full h-full z-[40] pointer-events-none">
        </div>

        <!-- Caixa de Instru√ß√µes Iniciais -->
        <div id="instructions"
            class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white/30 backdrop-blur-md p-6 rounded-lg text-center text-black shadow-lg z-[90] transform transition-all duration-2000"
            style="transform: translate(-50%, -50%);">
            <h2 class="font-bold text-2xl text-black">Pegue os Pandas!</h2>
            <p class="mt-2 text-black">Clique nos pandas antes que eles escapem!</p>
        </div>

        <!-- Camada de vegeta√ß√£o rasteira no ch√£o -->
        <div id="ground-vegetation" class="absolute bottom-0 left-0 w-full h-auto max-h-[40vh] z-[50] pointer-events-none"
            style="margin-bottom: -50px;">
            <img src="/static/imgs/fundo/matoRasteiro.png" alt="Vegeta√ß√£o rasteira"
                class="w-full h-full max-h-[40vh] object-cover object-bottom" style="min-height: 200px;">
        </div>

        <!-- Container para os Confetes/Cora√ß√µes -->
        <div id="confetti-container" class="absolute inset-0 w-full h-full z-40 pointer-events-none overflow-hidden">
        </div>





        <!-- == OS BAMBUS == -->

        <!-- Bambus Originais -->
        <div class="bamboo-stalk w-10 h-[90%] left-[5%] bottom-0 z-10">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 60%; top: 15%; left: 20%;"></div>
            <div class="bamboo-line" style="height: 40%; top: 40%; left: 70%;"></div>
            <div class="bamboo-joint" style="top: 10%;"></div>
            <div class="bamboo-joint" style="top: 35%;"></div>
            <div class="bamboo-joint" style="top: 60%;"></div>
        </div>
        <div class="bamboo-stalk w-12 h-full left-[15%] bottom-0 z-10 bamboo-mobile-hidden">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 70%; top: 5%; left: 30%;"></div>
            <div class="bamboo-line" style="height: 50%; top: 25%; left: 80%;"></div>
            <div class="bamboo-line" style="height: 30%; top: 60%; left: 10%;"></div>
            <div class="bamboo-joint" style="top: 15%;"></div>
            <div class="bamboo-joint" style="top: 40%;"></div>
            <div class="bamboo-joint" style="top: 65%;"></div>
            <div class="bamboo-joint" style="top: 90%;"></div>
        </div>

        <div class="bamboo-stalk w-10 h-[95%] left-[23%] bottom-0 z-21 bamboo-mobile-hidden">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 50%; top: 30%; left: 15%;"></div>
            <div class="bamboo-joint" style="top: 20%;"></div>
            <div class="bamboo-joint" style="top: 45%;"></div>
            <div class="bamboo-joint" style="top: 70%;"></div>
        </div>

        <div class="bamboo-stalk w-8 h-[85%] left-[30%] bottom-0 z-30">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 65%; top: 20%; left: 60%;"></div>
            <div class="bamboo-joint" style="top: 10%;"></div>
            <div class="bamboo-joint" style="top: 35%;"></div>
            <div class="bamboo-joint" style="top: 60%;"></div>
        </div>
        <div class="bamboo-stalk w-12 h-full left-[45%] bottom-0 z-10 bamboo-mobile-hidden">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 80%; top: 10%; left: 40%;"></div>
            <div class="bamboo-line" style="height: 45%; top: 30%; left: 85%;"></div>
            <div class="bamboo-joint" style="top: 15%;"></div>
            <div class="bamboo-joint" style="top: 40%;"></div>
            <div class="bamboo-joint" style="top: 65%;"></div>
            <div class="bamboo-joint" style="top: 90%;"></div>
        </div>

        <div class="bamboo-stalk w-10 h-[90%] left-[55%] bottom-0 z-10 bamboo-mobile-hidden">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 75%; top: 5%; left: 25%;"></div>
            <div class="bamboo-joint" style="top: 10%;"></div>
            <div class="bamboo-joint" style="top: 35%;"></div>
            <div class="bamboo-joint" style="top: 60%;"></div>
        </div>
        <div class="bamboo-stalk w-10 h-full left-[70%] bottom-0 z-10">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 60%; top: 10%; left: 10%;"></div>
            <div class="bamboo-line" style="height: 40%; top: 50%; left: 70%;"></div>
            <div class="bamboo-joint" style="top: 15%;"></div>
            <div class="bamboo-joint" style="top: 40%;"></div>
            <div class="bamboo-joint" style="top: 65%;"></div>
            <div class="bamboo-joint" style="top: 90%;"></div>
        </div>
        <div class="bamboo-stalk w-10 h-[65%] left-[38%] bottom-0 z-30 bamboo-mobile-hidden">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 55%; top: 15%; left: 25%;"></div>
            <div class="bamboo-joint" style="top: 20%;"></div>
            <div class="bamboo-joint" style="top: 50%;"></div>
        </div>
        <div class="bamboo-stalk w-8 h-[75%] left-[82%] bottom-0 z-30 bamboo-mobile-hidden">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 40%; top: 30%; left: 60%;"></div>
            <div class="bamboo-joint" style="top: 10%;"></div>
            <div class="bamboo-joint" style="top: 40%;"></div>
        </div>


        <!-- == NOVOS BAMBUS ADICIONADOS == -->
        <div class="bamboo-stalk w-8 h-[80%] left-[1%] bottom-0 z-5 bamboo-mobile-hidden">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 50%; top: 20%; left: 30%;"></div>
            <div class="bamboo-joint" style="top: 10%;"></div>
            <div class="bamboo-joint" style="top: 45%;"></div>
            <div class="bamboo-joint" style="top: 70%;"></div>
        </div>
        <div class="bamboo-stalk w-11 h-[98%] left-[8%] bottom-0 z-8 bamboo-mobile-hidden">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 65%; top: 10%; left: 70%;"></div>
            <div class="bamboo-line" style="height: 40%; top: 50%; left: 15%;"></div>
            <div class="bamboo-joint" style="top: 5%;"></div>
            <div class="bamboo-joint" style="top: 30%;"></div>
            <div class="bamboo-joint" style="top: 60%;"></div>
            <div class="bamboo-joint" style="top: 85%;"></div>
        </div>
        <div class="bamboo-stalk w-9 h-[70%] left-[28%] bottom-0 z-15 bamboo-mobile-hidden">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 30%; top: 60%; left: 40%;"></div>
            <div class="bamboo-joint" style="top: 25%;"></div>
            <div class="bamboo-joint" style="top: 55%;"></div>
        </div>
        <div class="bamboo-stalk w-10 h-[88%] left-[33%] bottom-0 z-28 bamboo-mobile-hidden">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 70%; top: 10%; left: 20%;"></div>
            <div class="bamboo-joint" style="top: 15%;"></div>
            <div class="bamboo-joint" style="top: 40%;"></div>
            <div class="bamboo-joint" style="top: 70%;"></div>
        </div>
        <div class="bamboo-stalk w-13 h-[92%] left-[50%] bottom-0 z-12 bamboo-mobile-hidden">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 85%; top: 5%; left: 50%;"></div>
            <div class="bamboo-joint" style="top: 10%;"></div>
            <div class="bamboo-joint" style="top: 38%;"></div>
            <div class="bamboo-joint" style="top: 68%;"></div>
        </div>
        <div class="bamboo-stalk w-9 h-[75%] left-[60%] bottom-0 z-18 bamboo-mobile-hidden">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 60%; top: 20%; left: 70%;"></div>
            <div class="bamboo-joint" style="top: 18%;"></div>
            <div class="bamboo-joint" style="top: 48%;"></div>
        </div>
        <div class="bamboo-stalk w-11 h-[80%] left-[75%] bottom-0 z-15 bamboo-mobile-hidden">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 55%; top: 15%; left: 30%;"></div>
            <div class="bamboo-joint" style="top: 12%;"></div>
            <div class="bamboo-joint" style="top: 42%;"></div>
            <div class="bamboo-joint" style="top: 72%;"></div>
        </div>
        <div class="bamboo-stalk w-7 h-[60%] left-[90%] bottom-0 z-8 bamboo-mobile-hidden">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 45%; top: 25%; left: 60%;"></div>
            <div class="bamboo-joint" style="top: 15%;"></div>
            <div class="bamboo-joint" style="top: 50%;"></div>
        </div>
        <div class="bamboo-stalk w-10 h-[95%] left-[95%] bottom-0 z-5">
            <div class="bamboo-detail"></div>
            <div class="bamboo-line" style="height: 70%; top: 5%; left: 20%;"></div>
            <div class="bamboo-joint" style="top: 10%;"></div>
            <div class="bamboo-joint" style="top: 35%;"></div>
            <div class="bamboo-joint" style="top: 65%;"></div>
            <div class="bamboo-joint" style="top: 90%;"></div>
        </div>



        <!-- Ch√£o da Floresta (em cima dos bambus) -->
        <div class="ground"></div>


        <!-- Vaga-lumes -->
        <div class="firefly" style="top: 20%; left: 10%;"></div>
        <div class="firefly" style="top: 50%; left: 30%;"></div>
        <div class="firefly" style="top: 70%; left: 50%;"></div>
        <div class="firefly" style="top: 15%; left: 70%;"></div>
        <div class="firefly" style="top: 40%; left: 90%;"></div>


    </div>

    <script>
        // JAVASCRIPT
        // Verifica√ß√£o de orienta√ß√£o e tela cheia
        function checkOrientation() {
            const orientationMessage = document.getElementById('orientation-message');
            const isPortrait = window.innerHeight > window.innerWidth;

            if (isPortrait && window.innerWidth < 768) { // Apenas para dispositivos m√≥veis
                orientationMessage.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            } else {
                orientationMessage.style.display = 'none';
                document.body.style.overflow = '';
            }
        }

        // Fun√ß√£o para ativar tela cheia
        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.error('Erro ao ativar tela cheia:', err);
                });
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }

        // Verificar orienta√ß√£o ao carregar e redimensionar
        window.addEventListener('load', checkOrientation);
        window.addEventListener('resize', checkOrientation);
        window.addEventListener('orientationchange', checkOrientation);

        // Bot√£o de tela cheia
        document.getElementById('fullscreen-btn').addEventListener('click', toggleFullScreen);

        // For√ßar orienta√ß√£o paisagem em dispositivos m√≥veis
        function lockOrientation() {
            if (screen.orientation && screen.orientation.lock) {
                screen.orientation.lock('landscape').catch(error => {
                    console.log('N√£o foi poss√≠vel bloquear a orienta√ß√£o:', error);
                });
            }
        }

        // Tentar travar a orienta√ß√£o quando o usu√°rio interagir
        document.addEventListener('click', function () {
            lockOrientation();
            // Tenta sair da tela cheia se estiver nela e o usu√°rio clicar
            if (document.fullscreenElement) {
                document.exitFullscreen();
            }
        }, { once: true });



        document.addEventListener('DOMContentLoaded', () => {
            // --- Seletores de Elementos ---
            const overlay = document.getElementById('overlay');
            const messageBox = document.getElementById('message-box');
            const messageText = document.getElementById('message-text');
            const instructions = document.getElementById('instructions');
            const confettiContainer = document.getElementById('confetti-container');

            // --- Canvas de Luz/Esconderijo (efeito spotlight dos vaga-lumes) ---
            const introCanvas = document.getElementById('introCanvas');
            const ctx = introCanvas.getContext('2d');
            const resizeCanvas = () => {
                introCanvas.width = window.innerWidth;
                introCanvas.height = window.innerHeight;
            };
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);

            const fireflies = Array.from(document.querySelectorAll('.firefly'));
            let darkness = { a: 1 }; // 1 = totalmente escuro; 0 = claro

            const renderMask = () => {
                const w = introCanvas.width;
                const h = introCanvas.height;
                ctx.clearRect(0, 0, w, h);

                // Camada de escurid√£o
                ctx.globalCompositeOperation = 'source-over';
                ctx.fillStyle = `rgba(0,0,0,${darkness.a})`;
                ctx.fillRect(0, 0, w, h);

                // Fura "buracos" com base nas posi√ß√µes dos vaga-lumes
                ctx.globalCompositeOperation = 'destination-out';
                const baseRadius = 90; // raio base do facho
                const extra = 60 * darkness.a; // mais forte quando est√° escuro
                fireflies.forEach(f => {
                    const r = f.getBoundingClientRect();
                    const x = r.left + r.width / 2;
                    const y = r.top + r.height / 2;
                    const radius = baseRadius + extra;
                    const grad = ctx.createRadialGradient(x, y, 0, x, y, radius);
                    grad.addColorStop(0.0, 'rgba(0,0,0,1)');
                    grad.addColorStop(0.6, 'rgba(0,0,0,0.4)');
                    grad.addColorStop(1.0, 'rgba(0,0,0,0)');
                    ctx.fillStyle = grad;
                    ctx.beginPath();
                    ctx.arc(x, y, radius, 0, Math.PI * 2);
                    ctx.fill();
                });

                // Glow sutil acima (para dar vida ao brilho)
                ctx.globalCompositeOperation = 'lighter';
                fireflies.forEach(f => {
                    const r = f.getBoundingClientRect();
                    const x = r.left + r.width / 2;
                    const y = r.top + r.height / 2;
                    const glowR = 40 + 20 * darkness.a;
                    const g = ctx.createRadialGradient(x, y, 0, x, y, glowR);
                    g.addColorStop(0.0, 'rgba(255,255,200,0.25)');
                    g.addColorStop(1.0, 'rgba(255,255,200,0)');
                    ctx.fillStyle = g;
                    ctx.beginPath();
                    ctx.arc(x, y, glowR, 0, Math.PI * 2);
                    ctx.fill();
                });

                ctx.globalCompositeOperation = 'source-over';
                requestAnimationFrame(renderMask);
            };
            requestAnimationFrame(renderMask);


            // --- 0. NOVO: Varia√ß√£o de Cor dos Bambus ---
            // Criando 5 varia√ß√µes de gradiente baseadas na sua cor
            const bambooColors = [
                // 2 tons mais escuros
                'linear-gradient(to right, rgb(14, 119, 14), rgb(24, 129, 24), rgb(14, 119, 14))', // Darkest
                'linear-gradient(to right, rgb(24, 129, 24), rgb(34, 139, 34), rgb(24, 129, 24))', // Dark
                // Tom base
                'linear-gradient(to right, rgb(34, 139, 34), rgb(44, 149, 44), rgb(34, 139, 34))', // Mid (Base)
                // 2 tons mais claros
                'linear-gradient(to right, rgb(44, 149, 44), rgb(54, 159, 54), rgb(44, 149, 44))', // Light
                'linear-gradient(to right, rgb(54, 159, 54), rgb(64, 169, 64), rgb(54, 159, 54))'  // Lightest
            ];

            // Aplica uma cor aleat√≥ria a cada bambu
            document.querySelectorAll('.bamboo-stalk').forEach(stalk => {
                const randomColor = bambooColors[Math.floor(Math.random() * bambooColors.length)];
                // Sobrescreve o CSS com o novo fundo
                stalk.style.background = randomColor;
            });

            // --- TONE.JS: Configura√ß√£o do Sintetizador M√°gico ---
            let synth;
            function initializeAudio() {
                // Inicializa o Tone.js (necess√°rio ap√≥s intera√ß√£o do usu√°rio)
                if (!synth) {
                    synth = new Tone.Synth({
                        oscillator: { type: "triangle" },
                        envelope: { attack: 0.02, decay: 0.1, sustain: 0.1, release: 0.5 },
                        volume: -10
                    }).toDestination();
                }
            }
            // Inicia a contagem regressiva para a transi√ß√£o
            let secondsLeft = 8;
            let countdownInterval = null;

            // Fun√ß√£o para verificar se est√° em modo vertical
            const isPortraitMode = () => {
                return window.innerHeight > window.innerWidth;
            };

            // Fun√ß√£o para pausar o contador
            const pauseCountdown = () => {
                if (countdownInterval) {
                    clearInterval(countdownInterval);
                    countdownInterval = null;
                    console.log('Contador pausado (modo vertical)');
                }
            };

            // Fun√ß√£o para iniciar/retomar o contador
            const startCountdown = () => {
                // Se j√° existe um intervalo rodando, n√£o cria outro
                if (countdownInterval) return;

                // Se j√° terminou, n√£o reinicia
                if (secondsLeft <= 0) return;

                console.log(`Contador iniciado/retomado. Tempo restante: ${secondsLeft} segundos`);

                countdownInterval = setInterval(() => {
                    // Verifica se est√° em modo vertical - se estiver, pausa imediatamente
                    if (isPortraitMode()) {
                        pauseCountdown();
                        return;
                    }

                    secondsLeft--;
                    console.log(`Tempo restante para o jogo come√ßar: ${secondsLeft} segundos`);

                    if (secondsLeft <= 0) {
                        clearInterval(countdownInterval);
                        countdownInterval = null;
                        const instructions = document.getElementById('instructions');

                        // Clareia a tela animando a escurid√£o do canvas de 1 -> 0 em 3s
                        gsap.to(darkness, {
                            a: 0,
                            duration: 3,
                            ease: 'sine.inOut',
                            onUpdate: () => {
                                // atualizado a cada frame pelo renderMask
                            },
                            onComplete: () => {
                                // Remove o canvas ap√≥s clarear
                                const c = document.getElementById('introCanvas');
                                if (c) c.remove();

                                // Anima a caixa de instru√ß√µes para baixo e fade-out
                                instructions.style.opacity = '1';
                                instructions.style.transform = 'translate(-50%, -50%)';
                                gsap.to(instructions, {
                                    y: '+=500px',
                                    opacity: 0,
                                    duration: 6,
                                    ease: 'sine.inOut',
                                    onComplete: () => {
                                        instructions.remove();
                                        console.log('Jogo iniciado!');
                                    }
                                });
                            }
                        });
                    }
                }, 1000);
            };

            // Inicia o contador apenas se n√£o estiver em modo vertical
            if (!isPortraitMode()) {
                startCountdown();
            }

            // Monitora mudan√ßas de orienta√ß√£o para pausar/retomar o contador
            const handleOrientationChange = () => {
                if (isPortraitMode()) {
                    // Se virou para vertical, pausa
                    pauseCountdown();
                } else {
                    // Se voltou para paisagem, retoma (se ainda tiver tempo)
                    if (!countdownInterval && secondsLeft > 0) {
                        startCountdown();
                    }
                }
            };

            window.addEventListener('resize', handleOrientationChange);
            window.addEventListener('orientationchange', handleOrientationChange);

            // Ouve o primeiro clique em qualquer lugar para iniciar o √°udio
            document.body.addEventListener('click', initializeAudio, { once: true });


            // --- 1. Anima√ß√£o de Balan√ßo dos Bambus (GSAP) ---
            // O GSAP pega TODOS os elementos com a classe .bamboo-stalk
            gsap.utils.toArray('.bamboo-stalk').forEach(stalk => {
                gsap.to(stalk, {
                    rotation: gsap.utils.random(-2.5, 2.5), // Balan√ßo leve
                    duration: gsap.utils.random(3, 5),     // Dura√ß√£o aleat√≥ria
                    transformOrigin: 'bottom center',
                    ease: 'sine.inOut',
                    repeat: -1,                           // Repetir para sempre
                    yoyo: true                            // Vai e volta
                });
            });

            // --- 2. Anima√ß√£o de Part√≠culas de Luz (Vaga-lumes) (GSAP) ---
            gsap.utils.toArray('.firefly').forEach(firefly => {
                const animateFirefly = () => {
                    gsap.to(firefly, {
                        x: gsap.utils.random(-200, 200), // Movimento aleat√≥rio
                        y: gsap.utils.random(-150, 150),
                        opacity: gsap.utils.random(0.4, 1),
                        scale: gsap.utils.random(0.8, 1.2),
                        duration: gsap.utils.random(4, 8),
                        ease: 'sine.inOut',
                        onComplete: animateFirefly // Reinicia a anima√ß√£o
                    });
                };
                animateFirefly(); // Inicia o movimento
                // Fade-in inicial
                gsap.fromTo(firefly, { opacity: 0 }, { opacity: gsap.utils.random(0.4, 1), duration: gsap.utils.random(1, 3) });
            });


            // --- 3. NOVO: Efeito Parallax (Apenas Desktop) ---
            const isTouchDevice = () => 'ontouchstart' in window || navigator.maxTouchPoints > 0;

            if (!isTouchDevice()) {
                const scene = document.getElementById('scene');

                // Seleciona todos os elementos que v√£o se mover
                const parallaxElements = document.querySelectorAll('.bamboo-stalk');

                scene.addEventListener('mousemove', (event) => {
                    // Mapeia a posi√ß√£o do mouse de [0, larguraTela] para [-1, 1]
                    const normX = gsap.utils.mapRange(0, window.innerWidth, -1, 1, event.clientX);
                    // Mapeia a posi√ß√£o do mouse de [0, alturaTela] para [-0.5, 0.5] (menos movimento vertical)
                    const normY = gsap.utils.mapRange(0, window.innerHeight, -0.5, 0.5, event.clientY);

                    parallaxElements.forEach(el => {
                        // Pega z-index, com fallback 10 se n√£o estiver definido
                        const zIndex = parseInt(window.getComputedStyle(el).zIndex, 10) || 10;
                        let strength = 0;

                        // Define a "for√ßa" do movimento com base no z-index
                        // Quanto maior o z-index, mais "perto" e mais se move
                        if (zIndex <= 10) {
                            strength = 5;  // Fundo (z-5, z-8, z-10) - move 5px max
                        } else if (zIndex <= 18) {
                            strength = 10; // Meio-fundo (z-12, z-15, z-18) - move 10px max
                        } else if (zIndex <= 25) {
                            strength = 18; // Meio-frente (z-20, z-21, z-25) - move 18px max
                        } else {
                            strength = 25; // Frente (z-26, z-28, z-30) - move 25px max
                        }

                        // Anima suavemente para a nova posi√ß√£o
                        // O GSAP combina isto com a anima√ß√£o de 'rotation' existente
                        gsap.to(el, {
                            x: normX * strength, // normX √© (-1 a 1), for√ßa √© (pixels)
                            y: normY * strength,
                            duration: 0.7,
                            ease: 'power2.out',
                        });
                    });
                });
            }


            // --- 4. L√≥gica do Jogo de Pegar Pandas ---
            const pandaGameContainer = document.getElementById('panda-game-container');
            const allMessages = [
                "Voc√™ pegou um panda! üêº",
    
            ];
            
            let availableMessages = [...allMessages]; // Mensagens dispon√≠veis
            let gameActive = true;

            // Configura√ß√µes dos movimentos
            const pandaMovements = [
                {
                    id: 1,
                    image: '/static/imgs/pandas/pandaVoando.png',
                    type: 'arc-physics-left-right'
                },
                {
                    id: 2,
                    image: '/static/imgs/pandas/pandaVoando.png',
                    type: 'arc-physics-right-left'
                },
                {
                    id: 3,
                    image: '/static/imgs/pandas/renam.png',
                    type: 'squat-random'
                },
                {
                    id: 4,
                    image: '/static/imgs/pandas/pandaRolando.png',
                    start: { x: Math.random() * (window.innerWidth - 80), y: window.innerHeight - 80 },
                    end: { x: Math.random() * (window.innerWidth - 80), y: -80 },
                    duration: 1800, // Mais r√°pido (era 2500ms)
                    type: 'vertical-up'
                },
                {
                    id: 5,
                    image: '/static/imgs/pandas/pandaRolando.png',
                    start: { x: -80, y: Math.random() * (window.innerHeight - 200) + 100 },
                    end: { x: window.innerWidth, y: Math.random() * (window.innerHeight - 200) + 100 },
                    duration: 800, // Muito mais r√°pido (era 1400ms)
                    type: 'horizontal'
                }
            ];

            let gameStarted = false;
            let spawnInterval;

            function createPanda(movementConfig) {
                const panda = document.createElement('div');
                panda.className = 'game-panda';
                // Adiciona classe espec√≠fica para este tipo de panda
                panda.classList.add(`panda-type-${movementConfig.id}`);
                panda.style.pointerEvents = 'auto';
                
                // Z-index aleat√≥rio entre as camadas dos bambus (5-35)
                const randomZIndex = Math.floor(Math.random() * 31) + 5; // 5 a 35
                panda.style.zIndex = randomZIndex;
                
                const img = document.createElement('img');
                img.src = movementConfig.image;
                img.alt = 'Panda';
                panda.appendChild(img);
                
                let x, y, vx, vy, gravity;
                const width = window.innerWidth;
                const height = window.innerHeight;
                const baseSpeedX = width * 0.003;
                const responsiveGravity = height * 0.0003;
                
                // Configura√ß√£o inicial baseada no tipo
                if (movementConfig.type === 'arc-physics-left-right') {
                    // 1: Esquerda -> Direita (Arco Perfeito)
                    x = -80;
                    // Nasce no ter√ßo inferior (75% a 90% da altura)
                    y = height * 0.75 + Math.random() * (height * 0.15);
                    gravity = responsiveGravity;
                    
                    // C√ÅLCULO F√çSICO: Define uma altura alvo aleat√≥ria (entre 15% e 30% do topo da tela)
                    const peakHeight1 = (height * 0.15) + Math.random() * (height * 0.15);
                    const jumpHeight1 = y - peakHeight1;
                    
                    // F√≥rmula: v = sqrt(2 * g * h) -> Velocidade exata para atingir aquela altura
                    vy = -Math.sqrt(2 * gravity * jumpHeight1);
                    
                    // Velocidade X aleat√≥ria mas suficiente para cruzar boa parte da tela
                    vx = baseSpeedX + Math.random() * (width * 0.002);
                    
                } else if (movementConfig.type === 'arc-physics-right-left') {
                    // 2: Direita -> Esquerda (Arco Perfeito)
                    x = width + 80;
                    y = height * 0.75 + Math.random() * (height * 0.15);
                    gravity = responsiveGravity;
                    
                    const peakHeight2 = (height * 0.15) + Math.random() * (height * 0.15);
                    const jumpHeight2 = y - peakHeight2;
                    
                    vy = -Math.sqrt(2 * gravity * jumpHeight2);
                    vx = -(baseSpeedX + Math.random() * (width * 0.002));
                    
                } else if (movementConfig.type === 'squat-random') {
                    // 3: Agachamento em posi√ß√µes aleat√≥rias no ch√£o
                    // Posi√ß√£o X aleat√≥ria (evitando muito perto das bordas)
                    x = 80 + Math.random() * (width - 160);
                    // Posi√ß√£o Y no ter√ßo inferior da tela (onde fica o ch√£o)
                    y = height * 0.65 + Math.random() * (height * 0.25);
                    
                    panda.style.left = x + 'px';
                    panda.style.top = y + 'px';
                    
                } else {
                    // Movimentos antigos para os outros tipos
                    panda.style.left = movementConfig.start.x + 'px';
                    panda.style.top = movementConfig.start.y + 'px';
                }
                
                pandaGameContainer.appendChild(panda);
                
                // Anima√ß√£o baseada no tipo de movimento
                if (movementConfig.type === 'arc-physics-left-right' || movementConfig.type === 'arc-physics-right-left') {
                    // Anima√ß√£o com f√≠sica de arco
                    let rotation = 0;
                    const animateArc = () => {
                        // Atualiza posi√ß√£o com f√≠sica
                        vy += gravity;
                        x += vx;
                        y += vy;
                        rotation += 5; // Rota√ß√£o enquanto voa
                        
                        // Atualiza posi√ß√£o do elemento
                        panda.style.left = x + 'px';
                        panda.style.top = y + 'px';
                        panda.style.transform = `rotate(${rotation}deg)`;
                        
                        // Verifica se ainda est√° vis√≠vel
                        if ((movementConfig.type === 'arc-physics-left-right' && x < width + 100) ||
                            (movementConfig.type === 'arc-physics-right-left' && x > -100)) {
                            if (y < height + 100) { // Ainda n√£o caiu completamente
                                requestAnimationFrame(animateArc);
                            } else {
                                removePanda(panda);
                            }
                        } else {
                            removePanda(panda);
                        }
                    };
                    
                    // Posi√ß√£o inicial
                    panda.style.left = x + 'px';
                    panda.style.top = y + 'px';
                    requestAnimationFrame(animateArc);
                    
                } else if (movementConfig.type === 'squat-random') {
                    // Anima√ß√£o de agachamento em posi√ß√£o aleat√≥ria
                    gsap.timeline()
                        .to(panda, {
                            y: -30,
                            duration: 0.5,
                            ease: 'power2.out'
                        })
                        .to(panda, {
                            y: 0,
                            duration: 0.5,
                            ease: 'power2.in'
                        })
                        .repeat(3)
                        .eventCallback('onComplete', () => removePanda(panda));
                } else {
                    // Anima√ß√µes antigas para os outros tipos
                    switch(movementConfig.type) {
                        case 'vertical-up':
                            gsap.to(panda, {
                                y: -(window.innerHeight + 80),
                                rotation: 720,
                                duration: movementConfig.duration / 1000,
                                ease: 'power2.out',
                                onComplete: () => removePanda(panda)
                            });
                            break;
                            
                        case 'horizontal':
                            gsap.to(panda, {
                                x: window.innerWidth + 80,
                                rotation: 180,
                                duration: movementConfig.duration / 1000,
                                ease: 'linear',
                                onComplete: () => removePanda(panda)
                            });
                            break;
                    }
                }
                
                // Evento de clique
                panda.addEventListener('click', () => {
                    if (!gameActive) return; // N√£o faz nada se o jogo terminou
                    
                    if (synth) {
                        synth.triggerAttackRelease("C5", "8n");
                    }
                    
                    // Pega uma mensagem aleat√≥ria das dispon√≠veis
                    if (availableMessages.length > 0) {
                        const randomIndex = Math.floor(Math.random() * availableMessages.length);
                        const message = availableMessages[randomIndex];
                        
                        // Remove a mensagem usada
                        availableMessages.splice(randomIndex, 1);
                        
                        // Mostra mensagem
                        messageText.textContent = message;
                        
                        gsap.timeline()
                            .to(overlay, { autoAlpha: 1, duration: 0.3, ease: 'power2.out' })
                            .fromTo(messageBox,
                                { scale: 0.5, opacity: 0, y: -30 },
                                { scale: 1, opacity: 1, y: 0, duration: 0.4, ease: 'back.out(1.7)' },
                                "-=0.2");
                        
                        // Verifica se todas as mensagens foram usadas
                        if (availableMessages.length === 0) {
                            endGame();
                        }
                    } else {
                        // Mensagem padr√£o se acabaram (n√£o deveria acontecer)
                        messageText.textContent = "Todas as mensagens foram usadas!";
                        
                        gsap.timeline()
                            .to(overlay, { autoAlpha: 1, duration: 0.3, ease: 'power2.out' })
                            .fromTo(messageBox,
                                { scale: 0.5, opacity: 0, y: -30 },
                                { scale: 1, opacity: 1, y: 0, duration: 0.4, ease: 'back.out(1.7)' },
                                "-=0.2");
                    }
                    
                    // Efeito de captura
                    gsap.to(panda, {
                        scale: 1.5,
                        opacity: 0,
                        duration: 0.3,
                        ease: 'back.in(1.7)',
                        onComplete: () => removePanda(panda)
                    });
                });
            }
            
            function removePanda(panda) {
                if (panda.parentNode) {
                    panda.remove();
                }
            }
            
            function spawnRandomPanda() {
                if (!gameActive) return; // N√£o spawna se o jogo terminou
                
                const randomMovement = pandaMovements[Math.floor(Math.random() * pandaMovements.length)];
                
                // Atualiza posi√ß√µes baseadas no tamanho atual da tela
                const movement = { ...randomMovement };
                if (movement.type === 'squat-random') {
                    // N√£o precisa de atualiza√ß√£o pois usa posi√ß√£o aleat√≥ria em tempo real
                } else if (movement.type === 'vertical-up') {
                    movement.start = { x: Math.random() * (window.innerWidth - 80), y: window.innerHeight - 80 };
                    movement.end = { x: movement.start.x, y: -80 };
                } else if (movement.type === 'horizontal') {
                    movement.start = { x: -80, y: Math.random() * (window.innerHeight - 200) + 100 };
                    movement.end = { x: window.innerWidth, y: movement.start.y };
                }
                // Os movimentos de arco n√£o precisam de atualiza√ß√£o pois usam physics em tempo real
                
                createPanda(movement);
            }
            
            function endGame() {
                gameActive = false;
                
                // Para de spawnar novos pandas
                if (spawnInterval) {
                    clearInterval(spawnInterval);
                    spawnInterval = null;
                }
                
                // Remove todos os pandas restantes
                const remainingPandas = document.querySelectorAll('.game-panda');
                remainingPandas.forEach(panda => {
                    gsap.to(panda, {
                        opacity: 0,
                        scale: 0,
                        duration: 0.5,
                        ease: 'back.in(1.7)',
                        onComplete: () => removePanda(panda)
                    });
                });
                
                // Inicia sequ√™ncia final ap√≥s 10 segundos (sem mensagem de parab√©ns)
                setTimeout(() => {
                    startFinalSequence();
                }, 10000);
            }
            
            function startFinalSequence() {
                // Cria o panda marrom final
                const finalPanda = document.createElement('div');
                finalPanda.className = 'game-panda panda-final';
                // Z-index aleat√≥rio entre os bambus tamb√©m para o panda final
                const randomZIndex = Math.floor(Math.random() * 31) + 5; // 5 a 35
                finalPanda.style.zIndex = randomZIndex;
                finalPanda.style.pointerEvents = 'none';
                
                const img = document.createElement('img');
                img.src = '/static/imgs/pandas/renanMarrom.png';
                img.alt = 'Panda Marrom';
                // Removido estilo inline para usar CSS da classe .panda-final
                finalPanda.appendChild(img);
                
                // Posi√ß√£o inicial (embaixo da tela)
                const startY = window.innerHeight + 100;
                // === ALTURA FINAL AQUI ===
                const endY = window.innerHeight * 0.5; // 50% da altura da tela (metade)
                const centerX = window.innerWidth / 2 - 100; // Centralizado
                
                finalPanda.style.left = centerX + 'px';
                finalPanda.style.top = startY + 'px';
                
                pandaGameContainer.appendChild(finalPanda);
                
                // Anima√ß√£o de subida lenta
                gsap.to(finalPanda, {
                    top: endY,
                    duration: 8, // 8 segundos para subir lentamente
                    ease: 'power1.inOut',
                    onComplete: () => {
                        // Espera 5 segundos no final
                        setTimeout(() => {
                            // Jumpscare
                            createJumpScare();
                        }, 5000);
                    }
                });
            }
            
            function createJumpScare() {
                // Remove o panda marrom
                const finalPanda = document.querySelector('.game-panda');
                if (finalPanda) {
                    finalPanda.remove();
                }
                
                // Cria o jumpscare sem fundo escuro
                const jumpScare = document.createElement('div');
                jumpScare.style.position = 'fixed';
                jumpScare.style.top = '0';
                jumpScare.style.left = '0';
                jumpScare.style.width = '100vw';
                jumpScare.style.height = '100vh';
                jumpScare.style.zIndex = '200'; // Acima de tudo
                jumpScare.style.display = 'flex';
                jumpScare.style.alignItems = 'center';
                jumpScare.style.justifyContent = 'center';
                // Sem backgroundColor - fundo transparente
                
                const jumpScareImg = document.createElement('img');
                jumpScareImg.src = '/static/imgs/pandas/pandaMarromJumpScare.png';
                jumpScareImg.alt = 'Jump Scare';
                jumpScareImg.style.width = '100%';
                jumpScareImg.style.height = '100%';
                jumpScareImg.style.objectFit = 'contain';
                
                jumpScare.appendChild(jumpScareImg);
                document.body.appendChild(jumpScare);
                
                // Efeito de entrada r√°pida
                gsap.fromTo(jumpScare,
                    { scale: 0, opacity: 0 },
                    { scale: 1, opacity: 1, duration: 0.2, ease: 'power2.in' }
                );
                
                // Som de jumpscare se dispon√≠vel
                if (synth) {
                    synth.triggerAttackRelease("C2", "16n");
                }
                
                // Remove ap√≥s 3 segundos e inicia sequ√™ncia final
                setTimeout(() => {
                    gsap.to(jumpScare, {
                        opacity: 0,
                        duration: 0.5,
                        onComplete: () => {
                            jumpScare.remove();
                            startEndSequence();
                        }
                    });
                }, 3000);
            }
            
            function startEndSequence() {
                // Cria overlay escuro para escurecer a tela
                const darkOverlay = document.createElement('div');
                darkOverlay.style.position = 'fixed';
                darkOverlay.style.top = '0';
                darkOverlay.style.left = '0';
                darkOverlay.style.width = '100vw';
                darkOverlay.style.height = '100vh';
                darkOverlay.style.backgroundColor = 'black';
                darkOverlay.style.opacity = '0';
                darkOverlay.style.zIndex = '150';
                darkOverlay.style.pointerEvents = 'none';
                document.body.appendChild(darkOverlay);
                
                // Escurece a tela por 5 segundos
                gsap.to(darkOverlay, {
                    opacity: 0.9,
                    duration: 5,
                    ease: 'power2.in',
                    onComplete: () => {
                        // Inicia os vaga-lumes invertidos
                        startReverseFireflies();
                    }
                });
            }
            
            function startReverseFireflies() {
                // Cria vaga-lumes invertidos (aparecendo em vez de desaparecendo)
                const fireflyCount = 15;
                const scene = document.getElementById('scene');
                
                for (let i = 0; i < fireflyCount; i++) {
                    const firefly = document.createElement('div');
                    firefly.className = 'firefly';
                    firefly.style.zIndex = '160'; // Acima do overlay escuro
                    
                    // Posi√ß√£o aleat√≥ria
                    const x = Math.random() * window.innerWidth;
                    const y = Math.random() * window.innerHeight;
                    firefly.style.left = x + 'px';
                    firefly.style.top = y + 'px';
                    firefly.style.opacity = '0'; // Come√ßa invis√≠vel
                    
                    scene.appendChild(firefly);
                    
                    // Anima√ß√£o de apari√ß√£o dos vaga-lumes
                    gsap.to(firefly, {
                        opacity: 1,
                        duration: 2,
                        delay: Math.random() * 3, // Aparece em momentos diferentes
                        ease: 'power2.inOut',
                        repeat: -1,
                        yoyo: true,
                        repeatDelay: Math.random() * 2
                    });
                    
                    // Movimento suave
                    gsap.to(firefly, {
                        x: x + (Math.random() - 0.5) * 100,
                        y: y + (Math.random() - 0.5) * 100,
                        duration: 4 + Math.random() * 4,
                        repeat: -1,
                        yoyo: true,
                        ease: 'sine.inOut'
                    });
                }
                
                // Cria o bot√£o continuar
                const continueBtn = document.createElement('button');
                continueBtn.textContent = 'continuar';
                continueBtn.style.position = 'fixed';
                continueBtn.style.top = '50%';
                continueBtn.style.left = '50%';
                continueBtn.style.transform = 'translate(-50%, -50%)';
                continueBtn.style.zIndex = '170'; // Acima dos vaga-lumes
                continueBtn.style.padding = '15px 30px';
                continueBtn.style.fontSize = '18px';
                continueBtn.style.backgroundColor = 'transparent';
                continueBtn.style.color = 'white';
                continueBtn.style.border = '2px solid white';
                continueBtn.style.borderRadius = '8px';
                continueBtn.style.cursor = 'pointer';
                continueBtn.style.opacity = '0';
                continueBtn.style.pointerEvents = 'auto';
                
                // Adiciona evento de clique
                continueBtn.addEventListener('click', () => {
                    // Recarrega a p√°gina para recome√ßar
                    window.location.reload();
                });
                
                document.body.appendChild(continueBtn);
                
                // Mostra o bot√£o com anima√ß√£o
                gsap.to(continueBtn, {
                    opacity: 1,
                    duration: 1,
                    delay: 2, // Aparece depois dos vaga-lumes
                    ease: 'power2.inOut'
                });
            }
            
            function startGame() {
                if (gameStarted) return;
                
                gameStarted = true;
                
                // Esconde instru√ß√µes
                gsap.to(instructions, { opacity: 0, duration: 0.5, onComplete: () => instructions.style.display = 'none' });
                
                // Come√ßa a spawnar pandas
                spawnInterval = setInterval(() => {
                    spawnRandomPanda();
                }, 2500); // Spawn a cada 2.5 segundos (era 1.5s)
                
                // Spawna o primeiro panda imediatamente
                setTimeout(spawnRandomPanda, 500);
            }
            
            // Inicia o jogo ap√≥s a introdu√ß√£o
            setTimeout(() => {
                startGame();
            }, 10000); // 10 segundos ap√≥s a introdu√ß√£o

            // --- 4. L√≥gica para Fechar o Modal ---
            overlay.addEventListener('click', () => {
                // Anima√ß√£o de sa√≠da do Modal (GSAP)
                gsap.timeline()
                    .to(messageBox, { scale: 0.5, opacity: 0, y: 50, duration: 0.3, ease: 'power2.in' })
                    .to(overlay, { autoAlpha: 0, duration: 0.4 }, "-=0.1"); // Esconde o overlay
            });

            // Impede que o clique na caixa de mensagem feche o modal
            messageBox.addEventListener('click', (e) => e.stopPropagation());


        });

    </script>
</body>

</html>